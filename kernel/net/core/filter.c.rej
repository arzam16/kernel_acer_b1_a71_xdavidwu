--- net/core/filter.c
+++ net/core/filter.c
@@ -322,8 +322,6 @@ load_b:
 
 			if (skb_is_nonlinear(skb))
 				return 0;
-			if (skb->len < sizeof(struct nlattr))
-				return 0;
 			if (A > skb->len - sizeof(struct nlattr))
 				return 0;
 
@@ -340,13 +338,11 @@ load_b:
 
 			if (skb_is_nonlinear(skb))
 				return 0;
-			if (skb->len < sizeof(struct nlattr))
-				return 0;
 			if (A > skb->len - sizeof(struct nlattr))
 				return 0;
 
 			nla = (struct nlattr *)&skb->data[A];
-			if (nla->nla_len > skb->len - A)
+			if (nla->nla_len > A - skb->len)
 				return 0;
 
 			nla = nla_find_nested(nla, X);
